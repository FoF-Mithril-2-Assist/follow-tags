module.exports=function(t){var o={};function n(r){if(o[r])return o[r].exports;var s=o[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=o,n.d=function(t,o,r){n.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,o){if(1&o&&(t=n(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var s in t)n.d(r,s,function(o){return t[o]}.bind(null,s));return r},n.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(o,"a",o),o},n.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},n.p="",n(n.s=19)}([function(t,o){t.exports=flarum.core.compat.extend},function(t,o,n){"use strict";var r;o.a=function(t){return r||(r=["none","tags","all"].reduce((function(o,n){return o[n]=app.translator.trans("fof-follow-tags."+t+".following_"+n+"_label"),o}),{}))}},function(t,o){t.exports=flarum.core.compat["components/Notification"]},function(t,o,n){"use strict";n.d(o,"a",(function(){return r}));var r={followingPageOptions:n(1).a}},function(t,o){t.exports=flarum.core.compat["helpers/icon"]},function(t,o){t.exports=flarum.core.compat["components/IndexPage"]},function(t,o){t.exports=flarum.core.compat["components/Dropdown"]},function(t,o){t.exports=flarum.core.compat["components/Button"]},function(t,o){t.exports=flarum.core.compat.Component},,function(t,o){t.exports=flarum.core.compat["components/NotificationGrid"]},function(t,o){t.exports=flarum.core.compat.Model},function(t,o){t.exports=flarum.core.compat["utils/extractText"]},function(t,o){t.exports=flarum.core.compat["components/DiscussionList"]},function(t,o){t.exports=flarum.core.compat["models/Discussion"]},function(t,o){t.exports=flarum.core.compat["components/Badge"]},function(t,o){t.exports=flarum.core.compat["components/SettingsPage"]},function(t,o){t.exports=flarum.core.compat["components/FieldSet"]},function(t,o){t.exports=flarum.core.compat["components/Select"]},function(t,o,n){"use strict";n.r(o),n.d(o,"utils",(function(){return r.a})),n.d(o,"components",(function(){return Y})),n.d(o,"forumUtils",(function(){return Z}));var r=n(3),s=n(0),i=n(10),e=n.n(i),a=n(11),l=n.n(a),u=n(5),c=n.n(u);function f(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o}var p=n(6),g=n.n(p),d=n(7),b=n.n(d),w=n(4),h=n.n(w),_=n(12),y=n.n(_);function v(){return(v=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var x,T,S=n(8),j=n.n(S),D=function(t){function o(){return t.apply(this,arguments)||this}return f(o,t),o.prototype.view=function(){var t={onclick:this.props.onclick,disabled:this.props.disabled};return m("button",v({className:"SubscriptionMenuItem hasIcon "+(this.props.disabled&&"disabled")},t),this.props.active?h()("fas fa-check",{className:"Button-icon"}):"",m("span",{className:"SubscriptionMenuItem-label"},h()(this.props.icon,{className:"Button-icon"}),m("strong",null,this.props.label),m("span",{className:"SubscriptionMenuItem-description"},this.props.description)))},o}(j.a),N=((x={})[!1]="fas fa-star",x.follow="fas fa-star",x.lurk="fas fa-comments",x.ignore="fas fa-bell-slash",x.hide="fas fa-eye-slash",x),P=function(t){function o(){return t.apply(this,arguments)||this}f(o,t);var n=o.prototype;return n.init=function(){this.loading=m.prop(!1),this.options=[{subscription:!1,icon:N[!1],label:app.translator.trans("fof-follow-tags.forum.sub_controls.not_following_button"),description:app.translator.trans("fof-follow-tags.forum.sub_controls.not_following_text")},{subscription:"follow",icon:N.follow,label:app.translator.trans("fof-follow-tags.forum.sub_controls.following_button"),description:app.translator.trans("fof-follow-tags.forum.sub_controls.following_text")},{subscription:"lurk",icon:N.lurk,label:app.translator.trans("fof-follow-tags.forum.sub_controls.lurking_button"),description:app.translator.trans("fof-follow-tags.forum.sub_controls.lurking_text")},{subscription:"ignore",icon:N.ignore,label:app.translator.trans("fof-follow-tags.forum.sub_controls.ignoring_button"),description:app.translator.trans("fof-follow-tags.forum.sub_controls.ignoring_text")},{subscription:"hide",icon:N.hide,label:app.translator.trans("fof-follow-tags.forum.sub_controls.hiding_button"),description:app.translator.trans("fof-follow-tags.forum.sub_controls.hiding_text")}]},n.view=function(){var t=this,o=this.props.tag,n=o.subscription()||!1,r=app.translator.trans("fof-follow-tags.forum.sub_controls.follow_button"),s=N[n]||"far fa-star",i="SubscriptionMenu-button--"+n;if(["follow","lurk","ignore","hide"].includes(n)){var e=["ignore","hide"].includes(n)?n.slice(0,n.length-1):n;r=app.translator.trans("fof-follow-tags.forum.sub_controls."+e+"ing_button")}var a=app.session.user.preferences(),l=a.notify_newPostInTag_email,u=a.notify_newPostInTag_alert,c=y()(app.translator.trans(l?"fof-follow-tags.forum.sub_controls.notify_email_tooltip":"fof-follow-tags.forum.sub_controls.notify_alert_tooltip")),f={className:"Button SubscriptionMenu-button "+i,icon:s,children:r,onclick:this.saveSubscription.bind(this,o,!["follow","lurk","ignore","hide"].includes(n)&&"follow"),title:c,loading:this.loading()};return(l||u)&&!1===n?f.config=function(t){$(t).tooltip({container:".SubscriptionMenu",placement:"bottom",delay:250,title:c})}:(f.config=function(t){return $(t).tooltip("destroy")},delete f.title),m("div",{className:"Dropdown ButtonGroup SubscriptionMenu App-primaryControl"},b.a.component(f),m("button",{className:"Dropdown-toggle Button Button--icon "+i,"data-toggle":"dropdown"},h()("fas fa-caret-down",{className:"Button-icon"})),m("ul",{className:"Dropdown-menu dropdown-menu Dropdown-menu--right"},this.options.map((function(r){return r.onclick=t.saveSubscription.bind(t,o,r.subscription),r.active=n===r.subscription,r.disabled="hide"===r.subscription&&o.isHidden(),m("li",null,D.component(r))}))))},n.saveSubscription=function(t,o){var n=this;this.loading(!0),app.request({url:app.forum.attribute("apiUrl")+"/tags/"+t.id()+"/subscription",method:"POST",data:{data:{subscription:o}}}).then((function(t){return app.store.pushPayload(t)})).then((function(){n.loading(!1),m.lazyRedraw()})),this.$(".SubscriptionMenu-button").tooltip("hide")},o}(g.a),O=n(13),k=n.n(O),I=function(){return m.route().includes(app.route("index.filter",{filter:"following"}))},M=n(1),B=function(){return T||(T=Object(M.a)("forum.index.following")),T},F=function(){B();var t=app.data["fof-follow-tags.following_page_default"];if(T[t]||(t=null),app.session.user){var o=app.session.user.preferences().followTagsPageDefault;T[o]&&(t=o)}return t||"none"},C=function(t){function o(){return t.apply(this,arguments)||this}f(o,t);var n=o.prototype;return n.view=function(){var t=app.cache.discussionList.followTags,o=this.options();return g.a.component({buttonClassName:"Button",label:o[t]||getDefaultFollowingFiltering(),children:Object.keys(o).map((function(n){var r=n===t;return b.a.component({active:r,children:o[n],icon:!r||"fas fa-check",onclick:function(){app.cache.discussionList.followTags=n,app.cache.discussionList.refresh()}})}))})},n.options=function(){return B()},o}(j.a),U=n(2),q=n.n(U),z=function(t){function o(){return t.apply(this,arguments)||this}f(o,t);var n=o.prototype;return n.icon=function(){return"fas fa-user-tag"},n.href=function(){var t=this.props.notification.subject();return app.route.discussion(t)},n.content=function(){return app.translator.trans("fof-follow-tags.forum.notifications.new_discussion_text",{user:this.props.notification.fromUser(),title:this.props.notification.subject().title()})},o}(q.a),L=function(t){function o(){return t.apply(this,arguments)||this}f(o,t);var n=o.prototype;return n.icon=function(){return N.lurk},n.href=function(){var t=this.props.notification,o=t.subject(),n=t.content()||{};return app.route.discussion(o,n.postNumber)},n.content=function(){return app.translator.trans("fof-follow-tags.forum.notifications.new_post_text",{user:this.props.notification.fromUser()})},o}(q.a),A=function(t){function o(){return t.apply(this,arguments)||this}f(o,t);var n=o.prototype;return n.icon=function(){return"fas fa-user-tag"},n.href=function(){var t=this.props.notification.subject();return app.route.discussion(t)},n.content=function(){return app.translator.trans("fof-follow-tags.forum.notifications.new_discussion_tag_text",{user:this.props.notification.fromUser(),title:this.props.notification.subject().title()})},o}(q.a),G=n(14),H=n.n(G),R=n(15),E=n.n(R);var J=n(16),K=n.n(J),Q=n(17),V=n.n(Q),W=n(18),X=n.n(W),Y={FollowingPageFilterDropdown:C,NewDiscussionNotification:z,NewDiscussionTagNotification:A,NewPostNotification:L,SubscriptionMenu:P,SubscriptionMenuItem:D},Z={options:T,getOptions:B,getDefaultFollowingFiltering:F,isFollowingPage:I};app.initializers.add("fof/follow-tags",(function(){app.initializers.has("flarum-tags")?(app.store.models.tags.prototype.subscription=l.a.attribute("subscription"),Object(s.extend)(c.a.prototype,"sidebarItems",(function(t){if(this.currentTag()&&app.session.user){var o=this.currentTag();t.replace("newDiscussion",t.get("newDiscussion"),10),t.add("subscription",P.component({tag:o,itemClassName:"App-primaryControl"}),5)}})),app.initializers.has("subscriptions")&&(Object(s.extend)(H.a.prototype,"badges",(function(t){if(I()){var o=this.tags().map((function(t){return t.subscription()})).filter((function(t){return["lurk","follow"].includes(t)})),n=o.includes("lurk")?"lurking":"following";o.length&&t.add("followTags",E.a.component({label:app.translator.trans("fof-follow-tags.forum.badge."+n+"_tag_tooltip"),icon:"fas fa-user-tag",type:n+"-tag"}))}})),Object(s.extend)(k.a.prototype,"requestParams",(function(t){if(I()&&app.session.user){this.followTags||(this.followTags=F());var o=t.filter.q||"",n=m.route.param().filter,r=this.followTags;"following"===n&&["tags","all"].includes(r)&&("tags"!==r&&"all"!==r||(o+=" is:following-tag"),"tags"===r&&(o=o.replace(" is:following","")),t.filter.q=o)}})),Object(s.extend)(c.a.prototype,"viewItems",(function(t){I()&&app.session.user&&t.add("follow-tags",m(C,null))})),Object(s.extend)(K.a.prototype,"settingsItems",(function(t){var o=this;t.add("fof-follow-tags",V.a.component({label:app.translator.trans("fof-follow-tags.forum.user.settings.heading"),className:"Settings-follow-tags",children:[m("div",{className:"Form-group"},m("p",null,app.translator.trans("fof-follow-tags.forum.user.settings.filter_label")),X.a.component({options:B(),value:this.user.preferences().followTagsPageDefault||F(),onchange:function(t){return o.preferenceSaver("followTagsPageDefault")(t)}}))]}))}))),app.notificationComponents.newPostInTag=L,app.notificationComponents.newDiscussionInTag=z,app.notificationComponents.newDiscussionTag=A,Object(s.extend)(e.a.prototype,"notificationTypes",(function(t){t.add("newDiscussionInTag",{name:"newDiscussionInTag",icon:"fas fa-user-tag",label:app.translator.trans("fof-follow-tags.forum.settings.notify_new_discussion_label")}),t.add("newPostInTag",{name:"newPostInTag",icon:"fas fa-user-tag",label:app.translator.trans("fof-follow-tags.forum.settings.notify_new_post_label")}),t.add("newDiscussionTag",{name:"newDiscussionTag",icon:"fas fa-user-tag",label:app.translator.trans("fof-follow-tags.forum.settings.notify_new_discussion_tag_label")})}))):console.error("[fof/follow-tags] flarum/tags is not enabled")}),-1)}]);
//# sourceMappingURL=forum.js.map